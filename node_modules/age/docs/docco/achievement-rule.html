<!DOCTYPE html>

<html>
<head>
  <title>achievement-rule.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="achievement-rule.html">
                achievement-rule.coffee
              </a>
            
              
              <a class="source" href="data-store.html">
                data-store.coffee
              </a>
            
              
              <a class="source" href="game-engine.html">
                game-engine.coffee
              </a>
            
              
              <a class="source" href="index.html">
                index.coffee
              </a>
            
              
              <a class="source" href="memory-data-store.html">
                memory-data-store.coffee
              </a>
            
              
              <a class="source" href="util.html">
                util.coffee
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>achievement-rule.coffee</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <p><strong>AchievementRule</strong> is an (optional) base type for rules that
define achievements within the GameEngine.</p>
<p>It is not necessary to extend this class to create an achievement rule.
Any object that provides the specified properties is sufficient.
This base class simply provides a handy place to document these assumptions
and to provide default properties that are sufficient for most use cases.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AchievementRule</span></span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>The <code>AchievementRule</code> constructor accepts an optional map of properties.</p>
<p>Four properties are recognized:</p>
<ol>
<li><p><em><code>multiplicity</code></em> -- an integer representing the number of times this
achievement can be earned by a single player. A value of <code>1</code> indicates
that the achievement can be awarded exactly once to a given player. A
value of <em>n</em> indicates that the achievement can be awarded exactly <em>n</em>
times to a given player. A value of <code>0</code> indicates that the achievement
can be awarded an infinite number of times.  Defaults to <code>0</code>.</p>
</li>
<li><p><em><code>transient</code></em> -- a boolean value indicating whether the achievement,
once awarded, becomes a permanent part of the player&#39;s game state,
or if the conditions must be re-evaluated each time. Defaults to <code>false</code>.</p>
<p>For example, an achievement such as &quot;logged-in today&quot; might be considered
transient while an achievement such as &quot;logged-in at least 10 times&quot; might
be considered permanent.</p>
</li>
<li><p><em><code>key</code></em> -- an identifier for this achievement (as stored within a player&#39;s
<code>achievements</code> container)</p>
<p>The <code>key</code> attribute can take several forms:</p>
<ul>
<li><p>a scalar string or number that acts as an identifier for this achievement</p>
</li>
<li><p>an array of strings or numbers, that indicates this single rule can
result in several achivements.  The <code>predicate</code> function will be evaluated
once for each element of the array.</p>
</li>
<li><p>a function that yields a scalar value or an array, in which case the
function is evaluated and the corresponding scalar or array is treated
as above.  This function is passed three arguments: a GameEngine instance,
a player object, and a callback function (that accepts an error parameter
and a key value).</p>
</li>
</ul>
<p>The latter case (the function) can be used to create dynamic identifiers.
For example, for an achievement such as &quot;Logged in on <DATE>&quot;.</p>
<p>No default value is provided for this property.  Instances or subclasses
must override this property.</p>
</li>
<li><p><em><code>predicate</code></em> -- a function (accepting three arguments: a GameEngine instance,
a player object and a callback function) that evaluates whether or not the
given player has earned this achievement.  The callback function accepts
two arguments: an error object (which should be <code>null</code> when no error has occurred)
and a boolean indicating whether or not the achievement has been achieved.</p>
<p>No default value is provided for this property.  Instances or subclasses
must provide a <code>predicate</code> method.</p>
</li>
</ol>
<p>Note that it is not necessary to pass these properties to the constructor method.
They could also be assigned in the subclass implementation or set after the
object is constructed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>  <span class="hljs-attribute">constructor</span>:<span class="hljs-function"><span class="hljs-params">(props={})</span>-&gt;</span>
    <span class="hljs-property">@multiplicity</span> = props?.multiplicity <span class="hljs-keyword">if</span> props?.multiplicity?
    <span class="hljs-property">@transient</span> = props?.transient <span class="hljs-keyword">if</span> props?.transient?
    <span class="hljs-property">@key</span> = props?.key <span class="hljs-keyword">if</span> props?.key?
    <span class="hljs-property">@predicate</span> = props?.predicate <span class="hljs-keyword">if</span> props.predicate?

  <span class="hljs-attribute">multiplicity</span>:<span class="hljs-number">1</span>
  <span class="hljs-attribute">transient</span>:<span class="hljs-literal">false</span>
  <span class="hljs-attribute">key</span>: <span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Error(<span class="hljs-string">"Method not implemented."</span>)
  <span class="hljs-attribute">predicate</span>: <span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span><span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> Error(<span class="hljs-string">"Method not implemented."</span>)</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>The AchievementRule type is exported under the name <code>AchievementRule</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="hljs-built_in">exports</span> = <span class="hljs-built_in">exports</span> ? <span class="hljs-keyword">this</span>
<span class="hljs-built_in">exports</span>.AchievementRule = AchievementRule</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
